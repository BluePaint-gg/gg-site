var dealer,gameActive=!1,searchValue="x",searchPlayer="x";export function registerClickEvents(){$("#startButton").click(buttonPress),$("#continue").click(moveOn),$("#cardContainer").on("click",".card",(function(){cardPress(this)})),$("#opponentContainer").on("click",".opponent",(function(){opponentPress(this)}))}function buttonPress(){gameActive||(dealer=new Dealer(requestPlayers()),sounds=new Sounds,gameActive=!0,alert("Hands dealt, ready to play.\n Click to begin."))}function moveOn(){gameActive&&playGame(searchValue,searchPlayer)}function cardPress(e){var a=$(e).attr("value");switch(searchValue=a,a){case"11":a="Jack";break;case"12":a="Queen";break;case"13":a="King";break;case"1":a="Ace"}$("#searchValue").html(a)}function opponentPress(e){var a=$(e).attr("number");searchPlayer=a,$("#searchPlayer").html("Opponent: "+searchPlayer)}function resetSearchValues(){$("#searchValue").html(""),$("#searchPlayer").html(""),searchValue="x",searchPlayer="x"}function playGame(e,a){if("x"!==e&&"x"!==a){for(var t=0;t<dealer.players.length;t++){var r=dealer.players[t],n=r.takeTurn();if(2!==n)if(0===n){if(!dealer.dealCard(r))continue}else{var s=r.callCardAndPlayer(dealer.players.length);instigateCall(s[0].value,dealer.players[s[1]],r)}else{if(r.getHand()>1&&!dealer.dealCard(r)){$("#playerInfo").html("Deck is empty. Please continue to end."),$("#continue").html("Continue");continue}instigateCall(parseInt(e),dealer.players[a],r),resetSearchValues(),r.getHand()>1&&$("#continue").html("Draw Card")}}if(!dealer.checkWinCondition()){var l=[],h=0;for(t=0;t<dealer.players.length;t++)dealer.players[t].getNumSets()>h?(h=dealer.players[t].getNumSets(),(l=[]).push(t)):dealer.players[t].getNumSets()===h&&l.push(t);for($("#cardContainer").empty(),t=0;t<l.length;t++)dealer.players[l[t]].id>1?$("#cardContainer").append("<h3>OPPONENT "+(dealer.players[l[t]].id-1)+" WINS!</h3>"):$("#cardContainer").append("<h3>YOU WIN!</h3>");gameActive=!1}}else $("playerInfo").html("Select opponent and card value to fish!")}function instigateCall(e,a,t){var r=dealer.findCardInPlayer(e,a);r.length<1&&dealer.dealCard(t);for(var n=a.removeCards(r),s=0;s<n.length;s++)t.addCard(n[s]);switch(e){case 11:e="Jack";break;case 12:e="Queen";break;case 13:e="King";break;case 1:e="Ace"}var l=a.id;t.human?(l="Opponent "+(a.id-1),r<1?$("#playerInfo").html("Hunted "+e+" from "+l+". GO FISH!"):$("#playerInfo").html("Hunted "+e+" from "+l+". Gained "+r.length+" cards!")):(l=1===l?"YOU":"Opponent "+(a.id-1),r<1?$(".actionExplain").eq(t.id-2).html("Hunted "+e+" from "+l+".<br>GO FISH!"):$(".actionExplain").eq(t.id-2).html("Hunted "+e+" from "+l+".<br>Gained "+r.length+" cards!"))}function requestPlayers(){do{var e=prompt("Choose a number of players, between 2 and 7!");e=parseInt(e)}while(NaN===e||e<2||e>7);return e}class Dealer{constructor(e){this.playerCount=e,this.players=[],this.MIN_PLAYERS=2,this.DEAL_THRESHOLD=4,this.MAX_PLAYERS=7,this.playDeck=new Deck,this.createPlayers(),this.dealHands()}createPlayers(){$("#opponentContainer").empty();for(var e=0;e<this.playerCount;e++){var a=new Player;if(a.id=e+1,0===e)a.setHuman();else{var t=e;$("#opponentContainer").append('<div class="opponent" number="'+t+'">\n<button class="" type="button">Opponent '+t+'</button>\n<h5>Sets:</h5>\n<h3 class="opponentSets">0</h3>\n<h5 class="actionExplain">==========</h5>\n</div>')}this.players.push(a)}this.playerNum=this.players.length}dealHands(){var e=0;if(this.playerCount>=this.MIN_PLAYERS&&this.playerCount<this.DEAL_THRESHOLD)e=7;else{if(!(this.playerCount>=this.DEAL_THRESHOLD&&this.playerCount<=this.MAX_PLAYERS))throw"invalidPlayerNumberException";e=5}for(var a=0;a<e;a++)for(var t=0;t<this.players.length;t++)this.dealCard(this.players[t])}dealCard(e){return!(this.playDeck.deck.length<1||(e.addCard(this.getCardFromDeck()),0))}findCardInPlayer(e,a){for(var t=[],r=0;r<a.hand.length;r++)a.hand[r].value===e&&t.push(r);return t}getCardFromDeck(){return this.playDeck.getCard()}checkWinCondition(){for(var e=0,a=0;a<this.players.length;a++)e+=this.players[a].getNumSets();return 13!==e}getPlayersLength(){return this.players.length}}class Player{constructor(){this.id=0,this.hand=[],this.human=!1,this.sets=[]}addCard(e){this.hand.push(e),this.sortHand(),this.checkHand()}getHand(){return this.hand}setHuman(){this.human=!0,this.humanController=new Human(this)}removeCards(e){for(var a=[],t=e.length-1;t>=0;t--){var r=this.hand[e[t]];this.hand.splice(e[t],1),a.push(r)}return this.human&&this.humanController.populateCardContainer(this.getHand()),this.checkHand(),a}takeTurn(){return this.human?this.hand.length<1?0:2:this.hand.length<1?0:1}callCardAndPlayer(e){do{var a=Math.floor(Math.random()*this.hand.length),t=Math.floor(Math.random()*e)}while(t===this.id-1);return[this.hand[a],t]}sortHand(){this.hand.sort((function(e,a){return e.value-a.value})),this.human&&this.humanController.populateCardContainer(this.getHand())}checkHand(){var e=0,a=1;if(this.hand.length<1&&this.human)this.humanController.emptyHand();else{this.human&&this.humanController.fullHand();for(var t=0;t<this.hand.length;t++)this.hand[t].value!==e?(e=this.hand[t].value,a=1):a++,4===a&&(this.playSet(this.hand[t].value),this.removeCards([t-3,t-2,t-1,t]))}}playSet(e){this.sets.push(e),this.updateSetsUI()}updateSetsUI(){var e="";if(this.human){for(var a=0;a<this.sets.length;a++){var t=" |"+this.sets[a]+"s| ";switch(this.sets[a]){case 11:t=" |Jacks| ";break;case 12:t=" |Queens| ";break;case 13:t=" |Kings| ";break;case 1:t=" |Aces| "}e+=t}$("#humanSets").html(e)}else{for(a=0;a<this.sets.length;a++){switch(t=" |"+this.sets[a]+"s| ",this.sets[a]){case 11:t=" |Jacks| ";break;case 12:t=" |Queens| ";break;case 13:t=" |Kings| ";break;case 1:t=" |Aces| "}e+=t}$("#opponentContainer").children("[number="+(this.id-1)+"]").eq(0).children(".opponentSets").eq(0).html(e)}}getNumSets(){return this.sets.length}getSets(){return this.sets}}class Human{constructor(){}setCardContainer(){this.cardContainer=$("#cardContainer")}populateCardContainer(e){this.clearBoard();for(var a=0;a<e.length;a++)this.addCardToContainer(e[a])}clearBoard(){$("#cardContainer").empty()}addCardToContainer(e){$("#cardContainer").append('<img class="card" src="'+e.image+'" value="'+e.value+'" alt="A card">')}emptyHand(){$("#continue").html("Draw Card"),searchValue="drawCard",searchPlayer="drawCard"}fullHand(){$("#continue").html("Take Turn"),searchValue="x",searchPlayer="x"}}class Sounds{constructor(){}}